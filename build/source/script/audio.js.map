{"version":3,"sources":["../../../source/script/audio-dev.js"],"names":["APlayer","_classCallCheck","this","el","splash","splashTitle","splashSubtitle","splashAuthor","splashLength","startBtn","resumeBtn","dwnldBtn","dwnldBtnMenu","main","mainBody","showProfileBtn","closeProfileBtn","profileDisplay","profileDisplayContent","profileDisplaySpinner","currentPic","trackTitle","trackAuthor","currentTrackNum","totalTracks","miniDisplay","upNextTrack","trackList","expandTracksBtn","ccSpecDisplay","spectrumDisplay","captionDisplay","bodyControls","ccToggle","spectrumToggle","next","previous","warning","error","errorIcon","errorTitle","errorBody","playerId","copyright","player","manifest","album","url","program","downloads","currentTrack","sameAuthor","sameAuthorLoaded","reference","names","_parseUri","window","location","href","params","URLSearchParams","search","marquee","start","stop","getManifest","self","manifestUrl","_selector","getAttribute","_requestFile","xhr","JSON","parse","response","ap_root_directory","length","setUIs","templateUrl","body","res","replace","innerHTML","getAlbum","_checkSupport","_setStartResumeListeners","_expandDownloadBtnMenu","_CCSpectrumDisplays","_expandTracksToggle","_setShowProfileListener","btn","querySelector","menu","addEventListener","setAttribute","hideSplash","setTrack","xml","responseXML","xmlSettings","_xmlSelector","xmlSetup","xmlTracks","settings","accent","splashFormat","trackImgFormat","analytics","version","title","textContent","subtitle","author","authorProfile","_isEmpty","undefined","name","course","tracks","Array","prototype","forEach","call","obj","src","img","_sanitize","push","console","log","setData","_setupAudioPlayer","num","currentTitle","_loadAuthorPic","upNextTrackTitle","ready","source","type","sources","once","togglePlay","_stopMarquee","_marqueeEl","track","localPicUrl","centralPicUrl","ap_author_directory","authorPic","Image","_fileExists","exist","appendChild","fileName","ap_download_files","file","format","link","document","createElement","label","style","display","dwnldFile","bgUrl","ap_splash_directory","splashBg","head","bgImg","backgroundImage","accentUrl","accentStyle","trackListDisplay","indx","li","a","numSpan","classList","add","titleWrprSpan","titleSpan","date","Date","year","getFullYear","ap_copyright","_setProgram","plyrControlsUrl","controls","Plyr","autoplay","volume","blankVideo","clickToPlay","fullscreen","enabled","fallback","iosNative","on","event","detail","plyr","playpauseBtn","muteUnmuteBtn","loopBtn","playbackRateBtn","nextBtn","prevBtn","i","options","Number","value","speed","selectedIndex","remove","loop","contains","restart","evt","target","ap_custom_themes","find","ap_logo_default","decorationBar","colors","hex","span","backgroundColor","hasCoreFeaturesSupport","showError","hasAppearanceIusses","showWarning","Modernizr","audio","json","svg","csscalc","flexbox","canvas","cssanimations","bgsizecover","objectfit","iconStr","titleStr","bodyStr","icon","ariaHidden","createAttribute","setAttributeNode","_fadeIn","str","hideTime","setTimeout","_fadeOut","authorProfileDisplay","closeBtn","index","currentAuthor","currentProfile","profileUrl","that","spinner","send","callback_name","callbackName","on_success","onSuccess","on_timeout","onTimeout","timeout","timeout_trigger","data","clearTimeout","script","async","getElementsByTagName","_setProfile","profile","closeProfile","bio","authorProfileDisplayContent","showProfile","minDisplay","_hideCCSpectrum","_slideDown","parentNode","setProperty","querySelectorAll","_slideUp","toggles","displays","toggleCC","toggleSpectrum","all","toLowerCase","trim","callback","request","XMLHttpRequest","open","onload","status","abort","onerror","found","arr","splice","test","pop","parts","split","lastIndexOf","_cleanArray","offsetWidth","scrollWidth","runTime","startTime","setInterval","width","clearInterval","animationEvt","_whichAnimationEvent","_event","_callback","_fadeCallback","removeEventListener","_slideCallback","ani","animations","animation","OAnimation","MozAnimation","WebkitAnimation","fn","attachEvent","readyState"],"mappings":"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","file":"audio.js","sourcesContent":["/*\n * Audio Player\n *\n * @author: Ethan Lin\n * @url: https://github.com/oel-mediateam/audioplayer\n * @version: 2.0.0\n *\n * @license: The MIT License (MIT)\n * Copyright (c) 2014 - 2018 Media Serivces\n *\n */\n\n'use strict';\n\nclass APlayer {\n    \n    constructor() {\n        \n        this.el = {\n            splash: '#ap-splash',\n            splashTitle: '#ap-splash .cover-info .title',\n            splashSubtitle: '#ap-splash .cover-info .subtitle',\n            splashAuthor: '#ap-splash .cover-info .author',\n            splashLength: '#ap-splash .cover-info .length',\n            startBtn: '#ap-start-btn',\n            resumeBtn: '#ap-resume-btn',\n            dwnldBtn: '#ap-dwnld-btn',\n            dwnldBtnMenu: '#ap-dwnld-btn .dropdown-content',\n            main: '#ap-main',\n            mainBody: '#ap-main .body',\n            showProfileBtn: '#show-profile',\n            closeProfileBtn: '#author-close-btn',\n            profileDisplay: '#author-overlay',\n            profileDisplayContent: '#author-overlay .content',\n            profileDisplaySpinner: '#author-overlay .spinner',\n            currentPic: '.head .track-img button',\n            trackTitle: '.track-info .title-wrapper .title',\n            trackAuthor: '.track-info .author',\n            currentTrackNum: '.track-info .meta .current',\n            totalTracks: '.track-info .meta .total',\n            miniDisplay: '.track-list .minimized-display',\n            upNextTrack: '.track-list .minimized-display .ap_up_next_title',\n            trackList: '.track-list .tracks',\n            expandTracksBtn: '.track-list .expand-btn',\n            ccSpecDisplay: '.body .cc-spec-display',\n            spectrumDisplay: '.body .cc-spec-display .spectrum',\n            captionDisplay: '.body .cc-spec-display .caption',\n            bodyControls: '.body .controls',\n            ccToggle: '#cc-toggle',\n            spectrumToggle: '#spectrum-toggle',\n            next: '#ap-next',\n            previous: '#ap-previous',\n            warning: '.body .warning-msg',\n            error: '#ap-error',\n            errorIcon: '#ap-error .icon',\n            errorTitle: '#ap-error .title',\n            errorBody: '#ap-error .body',\n            playerId: '#player',\n            copyright: '.copyright p',\n            player: null\n        };\n        \n        this.manifest ={};\n        this.album = {\n            url: 'assets/album.xml',\n            program: {},\n            downloads: [],\n            currentTrack: 0,\n            sameAuthor: true,\n            sameAuthorLoaded: false\n        };\n        this.player = null;\n        this.reference = {\n            names: this._parseUri( window.location.href ),\n            params: new URLSearchParams( window.location.search )\n        };\n        this.marquee ={\n            start: null,\n            stop: null\n        };\n        \n        this.getManifest();\n        \n    }\n    \n    getManifest() {\n        \n        let self = this;\n        let manifestUrl = self._selector( '#ap-manifest' ).getAttribute( 'href' );\n        \n        self._requestFile( manifestUrl, function( xhr ) {\n            \n            self.manifest = JSON.parse( xhr.response );\n            \n            if ( self.manifest.ap_root_directory.length === 0 ) {\n        \n                self.manifest.ap_root_directory = 'source/';\n                \n            }\n            \n            self.setUIs();\n            \n        } );\n        \n    }\n    \n    setUIs() {\n        \n        let self = this;\n        let templateUrl = self.manifest.ap_root_directory + 'script/templates/apui.tpl';\n        \n        self._requestFile( templateUrl, function( xhr ) {\n            \n            let body = self._selector( 'body' );\n            const res = xhr.response.replace( /\\{([source)]+)\\}/ig, self.manifest.ap_root_directory );\n            \n            body.innerHTML += res;\n            \n            self.getAlbum();\n            \n            self._checkSupport();\n            self._setStartResumeListeners();\n            self._expandDownloadBtnMenu();\n            self._CCSpectrumDisplays();\n            self._expandTracksToggle();\n            self._setShowProfileListener();\n            \n        } );\n        \n    }\n    \n    _expandDownloadBtnMenu() {\n        \n        let self = this;\n        \n        let dwnldBtn = self._selector( self.el.dwnldBtn );\n        let btn = dwnldBtn.querySelector( 'button' );\n        let menu = self._selector( self.el.dwnldBtnMenu );\n        \n        dwnldBtn.addEventListener( 'mouseenter', function() {\n            \n            btn.setAttribute( 'aria-expanded', true );\n            menu.setAttribute( 'aria-expanded', true );\n            \n        } );\n        \n        dwnldBtn.addEventListener( 'mouseleave', function() {\n            \n            btn.setAttribute( 'aria-expanded', false );\n            menu.setAttribute( 'aria-expanded', false );\n            \n        } );\n        \n    }\n    \n    _setStartResumeListeners() {\n        \n        let self = this;\n        \n        let startBtn = self._selector( self.el.startBtn );\n        let resumeBtn = self._selector( self.el.resumeBtn );\n        \n        startBtn.addEventListener( 'click', function() {\n            \n            self.hideSplash();\n            self.setTrack( self.album.currentTrack );\n            \n        } );\n        \n        resumeBtn.addEventListener( 'click', function() {\n            \n            self.hideSplash();\n            self.setTrack( self.album.currentTrack );\n            \n        } );\n        \n    }\n    \n    getAlbum() {\n        \n        let self = this;\n        \n        self._requestFile( self.album.url, function( xhr ) {\n            \n            const xml = xhr.responseXML;\n            const xmlSettings = self._xmlSelector( xml, 'album' );\n            const xmlSetup = self._xmlSelector( xml, 'setup' );\n            const xmlTracks = self._xmlSelector( xml, 'track', true );\n            \n            // settings\n            self.album.settings = {};\n            self.album.settings.accent = xmlSettings.getAttribute( 'accent' );\n            self.album.settings.splashFormat = '.' + xmlSettings.getAttribute( 'splashImgFormat' );\n            self.album.settings.trackImgFormat = '.' + xmlSettings.getAttribute( 'trackImgFormat' );\n            self.album.settings.analytics = xmlSettings.getAttribute( 'analytics' );\n            self.album.settings.version = xmlSettings.getAttribute( 'xmlVersion' );\n            \n            // setup\n            self.album.title = self._xmlSelector( xmlSetup, 'title' ).textContent;\n            self.album.subtitle = self._xmlSelector( xmlSetup, 'subtitle' ).textContent;\n            self.album.author = self._xmlSelector( xmlSetup, 'author' ).getAttribute( 'name' );\n            self.album.authorProfile = self._xmlSelector( xmlSetup, 'author' ).textContent;\n            self.album.length = self._xmlSelector( xmlSetup, 'length' ).textContent;\n            \n            // set program\n            if ( self._isEmpty( xmlSetup.getAttribute( 'program' ) ) ) {\n                \n                if ( self.reference.names[3] !== undefined ) {\n                    \n                    self.album.program.name = self.reference.names[3];\n                    \n                }\n                \n            } else {\n                \n                self.album.program.name = xmlSetup.getAttribute( 'program' );\n                \n            }\n            \n            // set course\n            if ( !self._isEmpty( xmlSetup.getAttribute( 'course' ) ) ) {\n                \n                self.album.program.course = xmlSetup.getAttribute( 'course' );\n                \n            }\n            \n            // track(s)\n            self.album.tracks = [];\n            \n            Array.prototype.forEach.call( xmlTracks, function( el) {\n                \n                let obj = {};\n            \n                obj.src = el.getAttribute( 'src' ) + '.mp3';\n                obj.title = el.querySelector( 'title' ).innerHTML;\n                obj.author = el.querySelector( 'author' ).getAttribute( 'name' );\n                obj.authorProfile = el.querySelector( 'author' ).innerHTML;\n                \n                if ( self._isEmpty( obj.author ) ) {\n                    \n                    obj.author = self.album.author;\n                    \n                }\n                \n                if ( obj.author !== self.album.author ) {\n                    self.album.sameAuthor = false;\n                }\n                \n                if ( self._isEmpty( obj.author ) ) {\n                    \n                    obj.img = self._sanitize( self.album.author ) + self.album.settings.trackImgFormat;\n                    \n                } else {\n                    \n                    obj.img = self._sanitize( obj.author ) + self.album.settings.trackImgFormat;\n                    \n                }\n\n                self.album.tracks.push( obj );\n                \n            } );\n            \n            console.log( self.album );\n            \n            self.setData();\n            self._setupAudioPlayer();\n            \n        } );\n        \n    }\n    \n    setTrack( num ) {\n        \n        // hold the class\n        let self = this;\n        \n        \n        // display title\n        let currentTitle = self._selector( self.el.trackTitle );\n            \n        currentTitle.innerHTML = self.album.tracks[num].title;\n        \n        // display author\n        let currentAuthor = self._selector( self.el.trackAuthor );\n        \n        currentAuthor.innerHTML = self.album.tracks[num].author;\n        \n        // load author picture if the track author is different\n        if ( !self.album.sameAuthor ) {\n\n            self._loadAuthorPic( self.album.tracks[num] );\n            \n        }\n        \n        // load author picture once if same author\n        if ( self.album.sameAuthor && self.album.sameAuthorLoaded === false ) {\n                \n            self._loadAuthorPic( self.album.tracks[num] );\n            self.album.sameAuthorLoaded = true;\n            \n        }\n        \n        // display and get current track number\n        if ( self.album.tracks.length > 1 ) {\n            \n            let currentTrack = self._selector( self.el.currentTrackNum );\n            currentTrack.innerHTML = num + 1;\n            \n            let totalTracks = self._selector( self.el.totalTracks );\n            totalTracks.innerHTML = self.album.tracks.length;\n            \n        }\n        \n        // display next track title\n        let upNextTrackTitle = self._selector( self.el.upNextTrack );\n        \n        if ( self.album.tracks.length > 1 && num < self.album.tracks.length - 1 ) {\n            \n            upNextTrackTitle.innerHTML = self.album.tracks[num + 1].title;\n            \n        }\n        \n        // play the audio if the player is ready after setting source\n        if ( self.player.ready ) {\n            \n            self.player.source = {\n                \n                type: 'audio',\n                title: self.album.tracks[num].title,\n                sources: [\n                    \n                    {\n                        \n                        src: 'assets/audio/' + self.album.tracks[num].src,\n                        type: 'audio/mp3'\n                        \n                    }\n                    \n                ],\n                \n            };\n                \n            self.player.once( 'canplay', function() {\n                \n                self.player.togglePlay();\n                \n            } );\n            \n        }\n        \n        // scroll the track title is applicable\n        self._stopMarquee( currentTitle );\n        self._marqueeEl( currentTitle );\n        \n    }\n    \n    _loadAuthorPic( track ) {\n        \n        let self = this;\n        let currentPic = self._selector( self.el.currentPic );\n        let localPicUrl = 'assets/images/' + track.img;\n        let centralPicUrl = self.manifest.ap_author_directory + self._sanitize( track.author ) + self.album.settings.trackImgFormat;\n        let authorPic = new Image();\n        \n        authorPic.src = self.manifest.ap_root_directory + 'images/pic.png';\n        \n        self._fileExists( localPicUrl, function( exist ) {\n            \n            if ( exist ) {\n                \n                authorPic.src = localPicUrl;\n                \n            } else {\n                \n                self._fileExists( centralPicUrl, function( exist ) {\n    \n                    if ( exist ) {\n                        \n                        authorPic.src = centralPicUrl;\n                        \n                    }\n                    \n                } );\n                \n            }\n            \n        } );\n        \n        currentPic.innerHTML = '';\n        currentPic.appendChild( authorPic );\n        \n    }\n    \n    setData() {\n        \n        let self = this;\n        \n        // DOM head elements\n        let pageTitle = this._selector( 'title' );\n        \n        pageTitle.innerHTML = this.album.title;\n        \n        // splash screen\n        let title = this._selector( this.el.splashTitle );\n        let subtitle = this._selector( this.el.splashSubtitle );\n        let author = this._selector( this.el.splashAuthor );\n        let length = this._selector( this.el.splashLength );\n        \n        title.innerHTML = this.album.title;\n        subtitle.innerHTML = this.album.subtitle;\n        author.innerHTML = this.album.author;\n        length.innerHTML = this.album.length;\n        \n        // splash download menu list\n        let fileName = self.reference.names;\n        \n        if ( fileName.length === 0 ) {\n            \n            fileName = 'album';\n            \n        } else {\n            \n            fileName = self.reference.names[self.reference.names.length - 1];\n            \n        }\n        \n        Array.prototype.forEach.call( this.manifest.ap_download_files, function( el ) {\n            \n            let file = fileName + '.' + el.format;\n            \n            self._fileExists( file, function( exist ) {\n                \n                if ( exist ) {\n                    \n                    let link = document.createElement( 'a' );\n            \n                    link.href = file;\n                    link.setAttribute( 'download', file );\n                    link.setAttribute( 'role', 'menuitem' );\n                    link.innerHTML = el.label;\n                    \n                    let dwnldMenu = self._selector( self.el.dwnldBtnMenu );\n                    dwnldMenu.appendChild( link );\n                    \n                    let dwnldBtn = self._selector( self.el.dwnldBtn );\n                    dwnldBtn.setAttribute( 'aria-hidden', false );\n                    dwnldBtn.style.display = 'block';\n                    \n                    let dwnldFile = {\n                        name: el.label,\n                        url: file\n                    };\n                    \n                    self.album.downloads.push( dwnldFile );\n                    \n                }\n                \n            } );\n            \n        } );\n        \n        // splash background image\n        if ( !this._isEmpty( this.album.program.name ) ) {\n            \n            let bgUrl = this.manifest.ap_splash_directory + this.album.program.name + '/default' + this.album.settings.splashFormat;\n            \n            if ( !this._isEmpty( self.album.program.course ) ) {\n                \n                bgUrl = this.manifest.ap_splash_directory + this.album.program.name + '/' + this.album.program.course + this.album.settings.splashFormat;\n                \n            }\n            \n            this._fileExists( bgUrl, function( exist ) {\n                \n                if ( exist ) {\n                    \n                    let splashBg = self._selector( self.el.splash );\n                    let head = self._selector( 'head' );\n                    let bgImg = 'url(\"' + bgUrl + '\")';\n                    \n                    splashBg.style.backgroundImage = bgImg;\n            \n                    // change the bg in the ap-main:before as well\n                    let style = document.createElement( 'style' );\n                    \n                    style.setAttribute( 'type', 'text/css' );\n                    style.innerHTML = '#ap-main:before{background-image: ' + bgImg + ' !important;}';\n                    \n                    head.appendChild( style );\n                    \n                }\n                \n            } );\n            \n        }\n        \n        // load accent\n        if ( !this._isEmpty( self.album.settings.accent ) ) {\n            \n            let accentUrl = this.manifest.ap_root_directory + 'script/templates/accent_css.tpl';\n            this._requestFile( accentUrl, function( xhr ) {\n                \n                const accentStyle = xhr.response.replace( /\\{([accent)]+)\\}/ig, self.album.settings.accent );\n                \n                let head = self._selector( 'head' );\n                let style = document.createElement( 'style' );\n                \n                style.setAttribute( 'type', 'text/css' );\n                style.innerHTML = accentStyle;\n                \n                head.appendChild( style );\n                \n            } );\n            \n        }\n        \n        // set tracks\n        if ( this.album.tracks.length > 1 ) {\n            \n            let trackListDisplay = this._selector( this.el.trackList );\n            \n            Array.prototype.forEach.call( this.album.tracks, function( el, indx ) {\n                \n                let li = document.createElement( 'li' );\n                let a = document.createElement( 'a' );\n                \n                a.href = 'javascript:void(0);';\n                \n                let numSpan = document.createElement( 'span' );\n                \n                numSpan.classList.add( 'track-num' );\n                numSpan.innerHTML = indx + 1 + '.';\n                \n                let titleWrprSpan = document.createElement( 'span' );\n                \n                titleWrprSpan.classList.add( 'track-title-wrapper' );\n                \n                let titleSpan = document.createElement( 'span' );\n                \n                titleSpan.classList.add( 'track-title' );\n                titleSpan.innerHTML = el.title;\n                \n                titleWrprSpan.appendChild( titleSpan );\n                \n                if ( !self.album.sameAuthor ) {\n                    \n                    let img = document.createElement( 'img' );\n                    let localPicUrl = 'assets/images/' + self.album.tracks[indx].img;\n                    let centralPicUrl = self.manifest.ap_author_directory + self._sanitize( self.album.tracks[indx].author ) + self.album.settings.trackImgFormat;\n                    \n                    img.classList.add( 'track-img' );\n                    img.src = self.manifest.ap_root_directory + 'images/pic.png';\n        \n                    self._fileExists( localPicUrl, function( exist ) {\n                        \n                        if ( exist ) {\n                            \n                            img.src = localPicUrl;\n                            \n                        } else {\n                            \n                            self._fileExists( centralPicUrl, function( exist ) {\n                \n                                if ( exist ) {\n                                    \n                                    img.src = centralPicUrl;\n                                    \n                                }\n                                \n                            } );\n                            \n                        }\n                        \n                    } );\n                    \n                    a.appendChild( img );\n                    \n                }\n                \n                a.appendChild( numSpan );\n                a.appendChild( titleWrprSpan );\n                \n                li.appendChild( a );\n                \n                trackListDisplay.appendChild( li );\n                \n            } );\n            \n        } else {\n            \n            this._selector( this.el.main ).classList.add( 'single' );\n            \n        }\n    \n        // copyright\n        let copyright = this._selector( this.el.copyright );\n        let date = new Date();\n        let year = date.getFullYear();\n        \n        copyright.innerHTML += '&copy; ' + year + '. ' + this.manifest.ap_copyright;\n        \n        // program theme\n        this._setProgram();\n        \n    }\n    \n    _setupAudioPlayer() {\n        \n        let self = this;\n        \n        let plyrControlsUrl = self.manifest.ap_root_directory + 'script/templates/single_plyr_controls.tpl';\n        \n        if ( self.album.tracks.length > 1 ) {\n            \n            plyrControlsUrl = self.manifest.ap_root_directory + 'script/templates/full_plyr_controls.tpl';\n            \n        }\n        \n        self._requestFile( plyrControlsUrl, function( xhr ) {\n            \n            const controls = xhr.response.replace( /\\{([source)]+)\\}/ig, self.manifest.ap_root_directory );\n                \n            self.el.player = new Plyr( self.el.playerId, {\n        \n                controls: controls,\n                autoplay: false,\n                volume: 0.8,\n                blankVideo: self.manifest.ap_root_directory + 'images/blank.m4v',\n                clickToPlay: false,\n                fullscreen: {\n                    enabled: false,\n                    fallback: false,\n                    iosNative: false\n                }\n                            \n            } );\n            \n            self.el.player.on( 'ready', event => {\n                \n                self.player = event.detail.plyr;\n                \n                const playpauseBtn = self._selector( '#ap-playpause' );\n                const muteUnmuteBtn = self._selector( '#ap-muteunmute' );\n                const loopBtn = self._selector( '#ap-loop' );\n                const playbackRateBtn = self._selector( '#ap-playbackRate' );\n                const nextBtn = self._selector( self.el.next );\n                const prevBtn = self._selector( self.el.previous );\n                const totalTracks = self.album.tracks.length - 1;\n                \n                // check playback rate and update playback rate select element\n                for ( var i = 0; i < playbackRateBtn.options.length; i++ ) {\n    \n                    if ( Number( playbackRateBtn.options[i].value ) === self.player.speed ) {\n                        \n                        playbackRateBtn.selectedIndex = i;\n                        break;\n                        \n                    }\n                    \n                }\n                \n                if ( self.album.currentTrack <= 0 ) {\n                    \n                    prevBtn.setAttribute( 'disabled', true );\n                    prevBtn.classList.add( 'disabled' );\n                }\n                \n                if ( self.album.currentTrack >= totalTracks ) {\n                            \n                    nextBtn.setAttribute( 'disabled', true );\n                    nextBtn.classList.add( 'disabled' );\n                    \n                }\n                \n                nextBtn.addEventListener( 'click', function() {\n                    \n                    \n                    if ( self.album.currentTrack < totalTracks ) {\n                        \n                        self.album.currentTrack++;\n                        self.setTrack( self.album.currentTrack );\n                        \n                    }\n                    \n                } );\n                \n                prevBtn.addEventListener( 'click', function() {\n                    \n                    if ( self.album.currentTrack > 0 ) {\n                        \n                        self.album.currentTrack--;\n                        self.setTrack( self.album.currentTrack );\n                        \n                    }\n                    \n                } );\n                \n                self.player.on( 'playing', function() {\n                    \n                    playpauseBtn.classList.add( 'plyr__control--pressed' );\n                    \n                } );\n                \n                self.player.on( 'pause', function() {\n                    \n                    playpauseBtn.classList.remove( 'plyr__control--pressed' );\n                    \n                } );\n                \n                // on playback end\n                self.player.on( 'ended', function() {\n                    \n                    if ( self.player.loop === false ) {\n                        \n                        if ( playpauseBtn.classList.contains( 'plyr__control--pressed' ) ) {\n                    \n                            playpauseBtn.classList.add( 'plyr__control--pressed' );\n                            \n                        }\n                        \n                        self.player.restart();\n                        \n                    }\n                    \n                } );\n                \n                // toogle loop button state\n                loopBtn.addEventListener( 'click', function() {\n    \n                    if ( self.player.loop === false ) {\n                        \n                        self.player.loop = true;\n                        loopBtn.classList.add( 'active' );\n                        \n                    } else {\n                        \n                        self.player.loop = false;\n                        loopBtn.classList.remove( 'active' );\n                        \n                    }\n                    \n                } );\n                \n                // change playback rate\n                playbackRateBtn.addEventListener( 'change', function( evt ) {\n                    \n                    self.player.speed = Number( evt.target.options[evt.target.selectedIndex].value );\n                    \n                } );\n                \n                // toglle mute/unmute state\n                muteUnmuteBtn.addEventListener( 'click', function( evt ) {\n                    \n                    if ( evt.target.classList.contains( 'plyr__control--pressed' ) ) {\n                        \n                        evt.target.classList.remove( 'plyr__control--pressed' );\n                        \n                    } else {\n                        \n                        evt.target.classList.add( 'plyr__control--pressed' );\n                        \n                    }\n                    \n                } );\n                    \n            } ); // end player ready event\n            \n        } );\n        \n    } // end _setupAudioPlayer\n    \n    _setProgram() {\n        \n        let self = this;\n        \n        if ( self.manifest.ap_custom_themes ) {\n            \n            self.album.program = self.manifest.ap_custom_themes.find( function ( obj ) {\n                \n                return obj.name === self.album.program.name;\n                \n            } );\n            \n            if ( self.album.program === undefined ) {\n                \n                self.album.program = self.manifest.ap_custom_themes.find( function ( obj ) {\n                    \n                    return obj.name === self.manifest.ap_logo_default;\n                    \n                } );\n                \n            }\n            \n        }\n        \n        let decorationBar = self._selector( '.program-theme' );\n    \n        self.album.program.colors.forEach( function( hex ) {\n                        \n            let span = document.createElement( 'span' );\n            span.style.backgroundColor = hex;\n            decorationBar.appendChild( span );\n            \n        } );\n        \n    }\n    \n    _checkSupport() {\n        \n        if ( this.hasCoreFeaturesSupport() ) {\n        \n            this.showError( '🙈', '', 'Your web browser does not support core audio player features.<br><a href=\"http://outdatedbrowser.com/en\" target=\"_blank\">Please update your web browser.</a>' );\n            return;\n            \n        }\n        \n        if ( this.hasAppearanceIusses() ) {\n        \n            this.showWarning( 'For better viewing, try a different web browser.' );\n            \n        }\n        \n    }\n    \n    hasCoreFeaturesSupport() {\n    \n        if ( !Modernizr.audio && Modernizr.json && Modernizr.svg\n             && Modernizr.csscalc && Modernizr.flexbox ) {\n            return true;\n        }\n        \n        return false;\n        \n    }\n    \n    hasAppearanceIusses() {\n    \n        if ( !Modernizr.canvas ) {\n            return true;\n        }\n        \n        if ( !Modernizr.cssanimations ) {\n            return true;\n        }\n        \n        if ( !Modernizr.bgsizecover ) {\n            return true\n        }\n        \n        if ( !Modernizr.objectfit ) {\n            return true\n        }\n        \n        return false;\n        \n    }\n    \n    showError( iconStr, titleStr, bodyStr ) {\n    \n        let splash = this._selector( this.el.splash );\n        let main = this._selector( this.el.main );\n        let error = this._selector( this.el.error );\n        let icon = this._selector( this.el.errorIcon );\n        let title = this._selector( this.el.errorTitle );\n        let body = this._selector( this.el.errorBody );\n        \n        let ariaHidden = document.createAttribute( 'aria-hidden' );\n        \n        ariaHidden.value = false;\n        \n        icon.innerHTML = iconStr;\n        title.innerHTML = titleStr;\n        body.innerHTML = bodyStr;\n        \n        splash.style.display = 'none';\n        main.style.display = 'none';\n        \n        error.style.display = 'flex';\n        error.setAttributeNode( ariaHidden );\n        \n        this._fadeIn( error );\n        \n    }\n    \n    showWarning( str ) {\n    \n        let self = this;\n        let warning = self._selector( self.el.warning );\n        let hideTime = 6000;\n        \n        warning.innerHTML = str;\n        warning.style.display = 'block';\n        \n        self._fadeIn( warning );\n        \n        window.setTimeout( function() {\n            \n            self._fadeOut( warning, function() {\n                \n                warning.innerHTML = '';\n                warning.style.display = 'none';\n                \n            } );\n            \n        }, hideTime );\n        \n    }\n    \n    hideSplash() {\n    \n        let splash = this._selector( this.el.splash );\n        let ariaHidden = document.createAttribute( 'aria-hidden' );\n        \n        ariaHidden.value = true;\n        \n        splash.classList.add( 'hide-splash' );\n        splash.setAttributeNode( ariaHidden );\n        \n    }\n    \n    showProfile() {\n        \n        let self = this;\n        let authorProfileDisplay = this._selector( this.el.profileDisplay );\n        let closeBtn = this._selector( this.el.closeProfileBtn );\n        let index = Number( self._selector( self.el.currentTrackNum ).innerHTML ) - 1;\n        \n        if ( self.album.tracks.length <= 1 ) {\n            index = 0;\n        }\n        \n        let currentAuthor = self.album.tracks[index].author;\n        let currentProfile = self.album.authorProfile;\n        \n        if ( !self._isEmpty( self.album.tracks[index].authorProfile) ) {\n            \n            currentProfile = self.album.tracks[index].authorProfile;\n            \n        }\n        \n        if ( self._isEmpty( currentProfile ) ) {\n            \n            let profileUrl = self.manifest.ap_author_directory + self._sanitize( currentAuthor ) + '.json?callback=author';\n        \n            let $jsonp = ( function() {\n                \n                let that = {};\n                let spinner = self._selector( self.el.profileDisplaySpinner );\n                \n                that.send = function( src, options ) {\n            \n                    spinner.classList.add( 'spin' );\n                    \n                    let callback_name = options.callbackName || 'callback',\n                        on_success = options.onSuccess || function() {},\n                        on_timeout = options.onTimeout || function() {},\n                        timeout = options.timeout || 10; // sec\n                \n                    let timeout_trigger = window.setTimeout( function() {\n                        window[callback_name] = function() {};\n                        spinner.classList.remove( 'spin' );\n                        on_timeout();\n                    }, timeout * 1000);\n                    \n                    window[callback_name] = function( data ) {\n                        window.clearTimeout( timeout_trigger );\n                        spinner.classList.remove( 'spin' );\n                        on_success( data );\n                    }\n                    \n                    let script = document.createElement( 'script' );\n                    script.type = 'text/javascript';\n                    script.async = true;\n                    script.src = src;\n                    \n                    document.getElementsByTagName( 'head' )[0].appendChild( script );\n                \n                }\n                \n                return that;\n                \n            } )();\n            \n            $jsonp.send( profileUrl, {\n                \n                callbackName: 'author',\n                onSuccess: function( json ) {\n                    \n                    self._setProfile( json.name, json.profile );\n                },\n                onTimeout: function() {\n                    \n                    self._setProfile( currentAuthor, currentProfile );\n                    \n                },\n                timeout: 5\n                \n            } );\n            \n        } else {\n            \n            self._setProfile( currentAuthor, currentProfile );\n            \n        }\n        \n        authorProfileDisplay.style.display = 'block';\n        this._fadeIn( authorProfileDisplay );\n        \n        closeBtn.addEventListener( 'click', function() {\n            self.closeProfile();\n        }, {once: true} );\n\n    }\n    \n    _setProfile( author, bio ) {\n        \n        let authorProfileDisplayContent = this._selector( this.el.profileDisplayContent );\n        \n        let name = document.createElement( 'h4' );\n                    \n        name.innerHTML = author;\n                        \n        let profile = document.createElement( 'div' );\n        \n        profile.innerHTML = bio;\n        \n        authorProfileDisplayContent.appendChild( name );\n        authorProfileDisplayContent.appendChild( profile );\n        \n    }\n    \n    closeProfile() {\n        \n        let authorProfileDisplay = this._selector( this.el.profileDisplay );\n        let authorProfileDisplayContent = this._selector( this.el.profileDisplayContent );\n        \n        this._fadeOut( authorProfileDisplay, function() {\n            \n            authorProfileDisplay.style.display = '';\n            \n            authorProfileDisplayContent.innerHTML = '';\n            \n        } );\n\n    }\n    \n    _setShowProfileListener() {\n        \n        let self = this;\n        let showProfileBtn = this._selector( this.el.showProfileBtn );\n        \n        showProfileBtn.addEventListener( 'click', function() {\n            \n            self.showProfile();\n            \n        } );\n        \n    }\n    \n    _expandTracksToggle() {\n        \n        let self = this;\n        let expandTracksBtn = self._selector( this.el.expandTracksBtn );\n        \n        expandTracksBtn.addEventListener( 'click', function() {\n            \n            let trackList = self._selector( self.el.trackList );\n            let minDisplay = self._selector( self.el.miniDisplay );\n            \n            if ( trackList.style.display == 'none' || trackList.style.display == '' ) {\n                \n                trackList.style.display = 'block';\n                minDisplay.style.display = 'none';\n                \n                self._hideCCSpectrum();\n                \n                self._slideDown( expandTracksBtn.parentNode, function() {\n                    \n                    expandTracksBtn.classList.add( 'rotate' );\n                    trackList.style.setProperty( 'overflow-y', 'auto' );\n                    \n                } );\n                \n                let tracks = document.querySelectorAll( self.el.trackList + ' .track-title-wrapper .track-title' );\n                \n                Array.prototype.forEach.call( tracks, function( el ) {\n                    \n                    self._marqueeEl( el );\n                    \n                } );\n                \n                \n                \n            } else {\n                \n                trackList.style.display = 'none';\n                trackList.style.setProperty( 'overflow-y', 'hidden' );\n                minDisplay.style.display = 'flex';\n                \n                self._slideUp( expandTracksBtn.parentNode, function() {\n                    \n                    expandTracksBtn.classList.remove( 'rotate' );\n                    self._CCSpectrumDisplays();\n                    \n                } );\n                \n            }\n            \n        } );\n        \n    }\n    \n    toggleCC() {\n        \n        let captionDisplay = this._selector( this.el.captionDisplay );\n        let spectrumDisplay = this._selector( this.el.spectrumDisplay );\n        let ccToggle = this._selector( this.el.ccToggle );\n        let spectrumToggle = this._selector( this.el.spectrumToggle );\n        \n        ccToggle.classList.add( 'disabled' );\n        spectrumToggle.classList.remove( 'disabled' );\n        \n        captionDisplay.classList.add( 'active' );\n        spectrumDisplay.classList.remove( 'active' );\n        \n    }\n    \n    toggleSpectrum() {\n        \n        let captionDisplay = this._selector( this.el.captionDisplay );\n        let spectrumDisplay = this._selector( this.el.spectrumDisplay );\n        let ccToggle = this._selector( this.el.ccToggle );\n        let spectrumToggle = this._selector( this.el.spectrumToggle );\n        \n        spectrumToggle.classList.add( 'disabled' );\n        ccToggle.classList.remove( 'disabled' );\n        \n        spectrumDisplay.classList.add( 'active' );\n        captionDisplay.classList.remove( 'active' );\n        \n    }\n    \n    _CCSpectrumDisplays() {\n        \n        let self = this;\n        let toggles = this._selector( this.el.bodyControls );\n        let displays = this._selector( this.el.ccSpecDisplay );\n        let ccToggle = this._selector( this.el.ccToggle );\n        let spectrumToggle = this._selector( this.el.spectrumToggle );\n        \n        if ( toggles.style.display === 'none' ) {\n            \n            toggles.style.display = '';\n            displays.style.display = '';\n            \n        } else {\n\n            self.toggleCC();\n            \n        }\n        \n        ccToggle.addEventListener( 'click', function() {\n            self.toggleCC();\n        } );\n        \n        spectrumToggle.addEventListener( 'click', function() {\n            self.toggleSpectrum();\n        } );\n        \n    }\n    \n    _hideCCSpectrum() {\n        \n        let displays = this._selector( this.el.ccSpecDisplay );\n        let toggles = this._selector( this.el.bodyControls );\n        \n        toggles.style.display = 'none';\n        displays.style.display = 'none';\n        \n    }\n    \n    /*** HELPER METHODS ***/\n    \n    _selector( str ) {\n        return document.querySelector( str );\n    }\n    \n    _xmlSelector( xml, str, all ) {\n        \n        all = typeof all === 'boolean' ? all : false;\n        \n        if ( all ) {\n            \n            return xml.querySelectorAll( str );\n            \n        } else {\n            \n            return xml.querySelector( str );\n            \n        }\n        \n    }\n    \n    _sanitize( str ) {\n        \n        return str.replace(/[^\\w]/gi, '').toLowerCase();\n    \n    }\n    \n    _isEmpty( str ) {\n        \n        if ( typeof str === 'string' && str.trim() === '' ) {\n            return true;\n        }\n        \n        if ( str === undefined ) {\n            return true;\n        }\n        \n        if ( str ===  null ) {\n            return true;\n        }\n        \n        return false;\n        \n    }\n    \n    _requestFile( url, callback ) {\n        \n        let self = this;\n        let body = self._selector( 'body' );\n        let request = new XMLHttpRequest();\n        \n        request.open( 'GET', url, true );\n        \n        request.onload = function() {\n            \n            if ( this.status >= 200 && this.status < 400 ) {\n                \n                callback( this );\n                \n            } else {\n                \n                body.innerHTML += '<div class=\"error\">Error ' + this.status + ' while loading <code>' + url + '</code></div>';\n                \n            }\n            \n            request.abort();\n            \n        };\n        \n        request.onerror = function() {\n            \n            body.innerHTML += '<div class=\"error\">Connection Error. Check your network.</div>';\n            \n        };\n        \n        request.send();\n        \n    }\n    \n    _fileExists( url, callback ) {\n        \n        let request = new XMLHttpRequest();\n        let found = false;\n        \n        request.open( 'HEAD', url, true );\n        \n        request.onload = function() {\n            \n            if ( this.status >= 200 && this.status < 400 ) {\n                \n                found = true;\n                \n            } else {\n                \n                found = false;\n                \n            }\n            \n            callback( found );\n            \n        };\n        \n        request.send();\n        \n    }\n    \n    _cleanArray( arr ) {\n    \n        arr.forEach( function( value, index ) {\n            \n            if ( value === '' ) {\n                arr.splice( index, 1 );\n            }\n            \n        } );\n        \n        if ( ( /(\\w*|(\\w*\\-\\w*)*)\\.\\w*/ig ).test( arr[arr.length-1] ) ) {\n            arr.pop();\n        }\n        \n        if ( ( /(\\w*|(\\w*\\-\\w*)*)\\:/ig ).test( arr[arr.length-1] ) ) {\n            arr.pop();\n        }\n        \n        return arr;\n        \n    }\n    \n    _parseUri( str ) {\n        \n        let parts =  str.split( '?' );\n        let target = parts[0];\n        \n        if ( target.lastIndexOf( '/' ) !== target.length - 1 ) {\n    \t\ttarget += '/';\n    \t}\n    \t\n    \treturn this._cleanArray( target.split( '/' ) );\n        \n    }\n    \n    /*** ANIMATION METHODS ***/\n    \n    _marqueeEl( el ) {\n        \n        let self = this;\n        \n        if ( el.offsetWidth < el.scrollWidth ) {\n            \n            let runTime = 15500;\n            let startTime = 5000;\n            \n            self.marquee.start = window.setInterval( function() {\n                \n                el.parentNode.classList.remove( 'stop-marquee' );\n                el.parentNode.classList.add( 'marquee' );\n                \n                el.style.width = el.scrollWidth + 'px';\n                \n                window.clearInterval( self.marquee.start );\n                \n                self.marquee.stop = window.setTimeout( function() {\n                     \n                    el.style.width = 'initial';\n                    el.parentNode.classList.remove( 'marquee' );\n                    window.clearTimeout( self.marquee.stop );\n                    \n                    self._fadeIn( el );\n                    self._marqueeEl( el );\n                    \n                }, runTime );\n                \n            }, startTime );\n            \n        }\n        \n    }\n    \n    _stopMarquee( el ) {\n        \n        el.style.width = '';\n        el.parentNode.classList.remove( 'marquee' );\n        el.parentNode.classList.add( 'stop-marquee' );\n        \n        if ( this.marquee.stop !== null ) {\n            window.clearTimeout( this.marquee.stop );\n        }\n        \n        if ( this.marquee.start !== null ) {\n            window.clearInterval( this.marquee.start );\n        }\n        \n    }\n    \n    _fadeIn( el, callback ) {\n        \n        el.classList.remove( 'fadeOut' );\n        el.classList.add( 'fadeIn' );\n        \n        let animationEvt = this._whichAnimationEvent();\n        \n        el.params = {\n            _event: animationEvt,\n            _callback: callback\n        };\n        \n        el.addEventListener( animationEvt, this._fadeCallback );\n        \n    }\n    \n    _fadeOut( el, callback ) {\n\n        el.classList.remove( 'fadeIn' );\n        el.classList.add( 'fadeOut' );\n        \n        let animationEvt = this._whichAnimationEvent();\n        \n        el.params = {\n            _event: animationEvt,\n            _callback: callback\n        };\n        \n        el.addEventListener( animationEvt, this._fadeCallback );\n        \n    }\n    \n    _fadeCallback( evt ) {\n        \n        if ( evt.target.params._callback !== undefined ) {\n            \n            if ( typeof evt.target.params._callback === 'function' ) {\n                \n                evt.target.params._callback();\n                \n            }\n            \n        }\n        \n        evt.target.classList.remove( 'fadeIn' );\n        evt.target.classList.remove( 'fadeOut' );\n        evt.target.removeEventListener( evt.target.params._event, this._fadeCallback );\n        \n    }\n    \n    _slideDown( el, callback ) {\n        \n        el.classList.add( 'slideDown' );\n        el.classList.remove( 'slideUp' );\n        \n        let animationEvt = this._whichAnimationEvent();\n        \n        el.params = {\n            _event: animationEvt,\n            _callback: callback\n        };\n        \n        el.addEventListener( animationEvt, this._slideCallback );\n        \n    }\n    \n    _slideUp( el, callback ) {\n        \n        let self = this;\n        el.classList.add( 'slideUp' );\n        el.classList.remove( 'slideDown' );\n        \n        let animationEvt = this._whichAnimationEvent();\n        \n        el.params = {\n            _event: animationEvt,\n            _callback: callback\n        };\n        \n        el.addEventListener( animationEvt, self._slideCallback );\n        \n    }\n    \n    _slideCallback( evt ) {\n        \n        let self = this;\n        \n        if ( evt.target.params !== undefined ) {\n            \n            if ( typeof evt.target.params._callback === 'function' ) {\n                \n                evt.target.params._callback();\n                \n            }\n            \n            evt.target.removeEventListener( evt.target.params._event, self._slideCallback );\n            \n        }\n        \n    } \n    \n    _whichAnimationEvent() {\n        \n        let ani;\n        let el = document.createElement( 'fakeelement' );\n        let animations = {\n            'animation': 'animationend',\n            'OAnimation': 'oAnimationEnd',\n            'MozAnimation': 'animationend',\n            'WebkitAnimation': 'webkitAnimationEnd'\n        }\n        \n        for ( ani in animations ) {\n            \n            if ( el.style[ani] !== undefined ) {\n                \n                return animations[ani];\n                \n            }\n            \n        }\n        \n    }\n    \n} // end APlayer class\n\n/**** ON DOM READY ****/\n( function ready( fn ) {\n    \n    if ( document.attachEvent ? document.readyState === 'complete' : document.readyState !== 'loading' ) {\n        \n        fn();\n        \n    } else {\n        \n        document.addEventListener( 'DOMContentLoaded', fn );\n        \n    }\n    \n} )( function() {\n    \n    new APlayer();\n    \n} );\n"]}